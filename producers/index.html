<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Producers - Maxwell's Daemon</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../maxwell.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">Maxwell's Daemon</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../quickstart/" class="nav-link">Quick Start</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../config/" class="dropdown-item">Reference</a>
</li>
                                    
<li>
    <a href="../deployment/" class="dropdown-item">Deployment</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Producers</a>
</li>
                                    
<li>
    <a href="../filtering/" class="dropdown-item">Filtering</a>
</li>
                                    
<li>
    <a href="../bootstrapping/" class="dropdown-item">Bootstrapping</a>
</li>
                                    
<li>
    <a href="../dataformat/" class="dropdown-item">Data Format</a>
</li>
                                    
<li>
    <a href="../encryption/" class="dropdown-item">Encryption</a>
</li>
                                    
<li>
    <a href="../monitoring/" class="dropdown-item">Monitoring</a>
</li>
                                    
<li>
    <a href="../high_availability/" class="dropdown-item">High Availability</a>
</li>
                                    
<li>
    <a href="../embedding/" class="dropdown-item">Embedding</a>
</li>
                                    
<li>
    <a href="../schemas/" class="dropdown-item">Internals</a>
</li>
                                    
<li>
    <a href="../compat/" class="dropdown-item">Compatibility</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../changelog/" class="nav-link">Changelog</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../deployment/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../filtering/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
<div class="col-md-4">
<div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#kafka" class="nav-link">Kafka</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#topic" class="nav-link">Topic</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#client-version" class="nav-link">Client version</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#passing-options-to-kafka" class="nav-link">Passing options to kafka</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#example-kafka-configs" class="nav-link">Example kafka configs</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#key-format" class="nav-link">Key format</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#partitioning" class="nav-link">Partitioning</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#kinesis" class="nav-link">Kinesis</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#aws-credentials" class="nav-link">AWS Credentials</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#options" class="nav-link">Options</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#sqs" class="nav-link">SQS</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#aws-credentials_1" class="nav-link">AWS Credentials</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#options_1" class="nav-link">Options</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#sns" class="nav-link">SNS</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#aws-credentials_2" class="nav-link">AWS Credentials</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#options_2" class="nav-link">Options</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#nats" class="nav-link">Nats</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#google-cloud-pubsub" class="nav-link">Google Cloud Pub/Sub</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#google-cloud-bigquery" class="nav-link">Google Cloud BigQuery</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#rabbitmq" class="nav-link">RabbitMQ</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#redis" class="nav-link">Redis</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#custom-producer" class="nav-link">Custom Producer</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#topic-substitution" class="nav-link">Topic substitution</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div>
</div>
<div class="col-md-8" role="main">
    <div id="Producers">
        

<h1 id="kafka">Kafka</h1>
<hr />
<h2 id="topic">Topic</h2>
<p>Maxwell writes to a kafka topic named "maxwell" by default. It is configurable
via <code>--kafka_topic</code>.  The given topic can be a plain string or a dynamic
string, e.g. <code>namespace_%{database}_%{table}</code>, where the topic will be
generated from data in the row.</p>
<h2 id="client-version">Client version</h2>
<p>By default, maxwell uses the kafka 1.0.0 library. The <code>--kafka_version</code> flag
lets you choose an alternate library version: 0.8.2.2, 0.9.0.1, 0.10.0.1, 0.10.2.1 or
0.11.0.1, 1.0.0.  This flag is only available on the command line.</p>
<ul>
<li>The 0.8.2.2 client is only compatible with brokers running kafka 0.8.</li>
<li>The 0.10.0.x client is only compatible with brokers 0.10.0.x or later.</li>
<li>Mixing the 0.10 client with other versions can lead to serious performance impacts.
  For More details, <a href="http://kafka.apache.org/0100/documentation.html#upgrade_10_performance_impact">read about it here</a>.</li>
<li>The 0.11.0 client can talk to version 0.10.0 or newer brokers.</li>
<li>The 0.9.0.1 client is not compatible with brokers running kafka 0.8. The exception below will show in logs when that is the case:</li>
</ul>
<pre><code>ERROR Sender - Uncaught error in kafka producer I/O thread:
SchemaException: Error reading field 'throttle_time_ms': java.nio.BufferUnderflowException
</code></pre>
<h2 id="passing-options-to-kafka">Passing options to kafka</h2>
<p>Any options present in <code>config.properties</code> that are prefixed with <code>kafka.</code> will
be passed into the Kafka producer library (with <code>kafka.</code> stripped off, see below for examples).  We use
the "new producer" configuration, as described here:
<a href="http://kafka.apache.org/documentation.html#newproducerconfigs">http://kafka.apache.org/documentation.html#newproducerconfigs</a></p>
<h2 id="example-kafka-configs">Example kafka configs</h2>
<h3 id="highest-throughput">Highest throughput</h3>
<p>These properties would give high throughput performance.</p>
<pre><code>kafka.acks = 1
kafka.compression.type = snappy
kafka.retries=0
</code></pre>
<h3 id="most-reliable">Most reliable</h3>
<p>For at-least-once delivery, you will want something more like:</p>
<pre><code>kafka.acks = all
kafka.retries = 5 # or some larger number
</code></pre>
<p>And you will also want to set <code>min.insync.replicas</code> on Maxwell's output topic.</p>
<h2 id="key-format">Key format</h2>
<p>Maxwell generates keys for its Kafka messages based upon a mysql row's primary key in JSON format:</p>
<pre><code>{ &quot;database&quot;:&quot;test_tb&quot;,&quot;table&quot;:&quot;test_tbl&quot;,&quot;pk.id&quot;:4,&quot;pk.part2&quot;:&quot;hello&quot;}
</code></pre>
<p>This key is designed to co-operate with Kafka's log compaction, which will save the last-known
value for a key, allowing Maxwell's Kafka stream to retain the last-known value for a row and act
as a source of truth.</p>
<h1 id="partitioning">Partitioning</h1>
<hr />
<p>Kafka, AWS Kinesis/SNS/SQS support the notion of partitioned streams.
Because they like to make our lives hard, Kafka calls its two units "topics"
and "partitions", Kinesis calls them "streams" and "shards", and SNS/SQS calls them "group id". 
They're the same thing, though.  Maxwell is generally configured to write to N
partitions/shards on one topic/stream, and how it distributes to those N
partitions/shards can be controlled by <code>producer_partition_by</code>.</p>
<p><code>producer_partition_by</code> gives you a choice of splitting your stream by database, table,
primary key, transaction id, column data, or "random".  How you choose
to partition your stream greatly influences the load and serialization properties
of your downstream consumers, so choose carefully.  A good rule of thumb is to
use the finest-grained partition scheme possible given serialization
constraints.</p>
<blockquote>
<p><em>A brief partitioning digression:</em></p>
<p>If I were building, say, a simple search index of a single table, I might
choose to partition by primary key; this would give you the best distribution
of workload amongst your stream processors while maintaining a strict ordering
of updates that happen to a certain row.</p>
<p>If I were building something that needed better serialization properties --
let's say I needed to maintain strict ordering between updates that occured on
different tables -- I would drop back to partitioning by table or database.
This will reduce my throughput by a <em>lot</em> as a single stream consumer node will
end up will all the load for particular table/database, but I'm guaranteed that
the updates stay in order.</p>
</blockquote>
<p>If you choose to partition by column data (that is, values inside columns in
your updates), you must set both:</p>
<ul>
<li><code>producer_partition_columns</code> - a comma-separated list of column names, and</li>
<li><code>producer_partiton_by_fallback</code> - [<em>database</em>, <em>table</em>,
  <em>primary_key</em>] - this will be used as the partition key when the column does not
  exist.</li>
</ul>
<p>When partitioning by column Maxwell will treat the values for the specified
columns as strings, concatenate them and use that value to partition the data.</p>
<h3 id="kafka-partitioning">Kafka partitioning</h3>
<p>A binlog event's partition is determined by the selected hash function and hash string as follows</p>
<pre><code>  HASH_FUNCTION(producer_partion_value) % TOPIC.NUMBER_OF_PARTITIONS
</code></pre>
<p>The HASH_FUNCTION is either java's <em>hashCode</em> or <em>murmurhash3</em>. The default
HASH_FUNCTION is <em>hashCode</em>. Murmurhash3 may be set with the
<code>kafka_partition_hash</code> option. The seed value for the murmurhash function is
hardcoded to 25342 in the MaxwellKafkaPartitioner class.  We tell you this
in case you need to reverse engineer where a row will land.</p>
<p>Maxwell will discover the number of partitions in its kafka topic upon boot.
This means that you should pre-create your kafka topics:</p>
<pre><code>bin/kafka-topics.sh --zookeeper ZK_HOST:2181 --create \
                    --topic maxwell --partitions 20 --replication-factor 2
</code></pre>
<p><a href="http://kafka.apache.org/documentation.html#quickstart">http://kafka.apache.org/documentation.html#quickstart</a></p>
<h1 id="kinesis">Kinesis</h1>
<hr />
<h2 id="aws-credentials">AWS Credentials</h2>
<p>You will need to obtain an IAM user that has the following permissions for the stream you are planning on producing to:</p>
<ul>
<li>"kinesis:PutRecord"</li>
<li>"kinesis:PutRecords"</li>
<li>"kinesis:DescribeStream"</li>
</ul>
<p>Additionally, the producer will need to be able to produce CloudWatch metrics which requires the following permission applied to the resource `*``:
- "cloudwatch:PutMetricData"</p>
<p>The resulting IAM policy document may look like this:</p>
<pre><code class="language-json">{
    &quot;Version&quot;: &quot;2012-10-17&quot;,
    &quot;Statement&quot;: [
        {
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;kinesis:PutRecord&quot;,
                &quot;kinesis:PutRecords&quot;,
                &quot;kinesis:DescribeStream&quot;
            ],
            &quot;Resource&quot;: &quot;arn:aws:kinesis:us-west-2:123456789012:stream/my-stream&quot;
        },
        {
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;cloudwatch:PutMetricData&quot;
            ],
            &quot;Resource&quot;: &quot;*&quot;
        }
    ]
}
</code></pre>
<p>See the <a href="http://docs.aws.amazon.com/streams/latest/dev/controlling-access.html#kinesis-using-iam-examples">AWS docs</a> for the latest examples on which permissions are needed.</p>
<p>The producer uses the <a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/auth/DefaultAWSCredentialsProviderChain.html">DefaultAWSCredentialsProviderChain</a> class to gain aws credentials.
See the <a href="http://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/credentials.html">AWS docs</a> on how to setup the IAM user with the Default Credential Provider Chain.</p>
<h2 id="options">Options</h2>
<p>Set the output stream in <code>config.properties</code> by setting the <code>kinesis_stream</code> property.</p>
<p>The producer uses the <a href="http://docs.aws.amazon.com/streams/latest/dev/developing-producers-with-kpl.html">KPL (Kinesis Producer Library)</a> and uses the KPL built in configurations.
Copy <code>kinesis-producer-library.properties.example</code> to <code>kinesis-producer-library.properties</code> and configure the properties file to your needs.</p>
<p>You are <strong>required</strong> to configure the region. For example:</p>
<pre><code># set explicitly
Region=us-west-2
# or set with an environment variable
Region=$AWS_DEFAULT_REGION
</code></pre>
<p>By default, the KPL implements <a href="http://docs.aws.amazon.com/streams/latest/dev/kinesis-kpl-concepts.html#w2ab1c12b7b7c19c11">record aggregation</a>, which usually increases producer throughput by allowing you to increase the number of records sent per API call. However, aggregated records are encoded differently (using Google Protocol Buffers) than records that are not aggregated. Therefore, if you are not using the <a href="http://docs.aws.amazon.com/streams/latest/dev/developing-consumers-with-kcl.html">KCL (Kinesis Client Library)</a> to consume records (for example, you are using AWS Lambda) you will need to either disaggregate the records in your consumer (for example, by using the <a href="https://github.com/awslabs/kinesis-aggregation">AWS Kinesis Aggregation library</a>), or disable record aggregation in your <code>kinesis-producer-library.properties</code> configuration.</p>
<p>To disable aggregation, add the following to your configuration:</p>
<pre><code>AggregationEnabled=false
</code></pre>
<p>Remember: if you disable record aggregation, you will lose the benefit of potentially greater producer throughput.</p>
<h1 id="sqs">SQS</h1>
<hr />
<h2 id="aws-credentials_1">AWS Credentials</h2>
<p>You will need to obtain an IAM user that has the permission to access the SQS service. The SQS producer also uses <a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/auth/DefaultAWSCredentialsProviderChain.html">DefaultAWSCredentialsProviderChain</a> to get AWS credentials.</p>
<p>See the <a href="http://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/credentials.html">AWS docs</a> on how to setup the IAM user with the Default Credential Provider Chain.</p>
<p>In case you need to set up a different region also along with credentials then default one, see the <a href="http://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/setup-credentials.html#setup-credentials-setting-region">AWS docs</a>.</p>
<h2 id="options_1">Options</h2>
<p>Set the output queue in the <code>config.properties</code> by setting the following properites</p>
<ul>
<li><strong>sqs_signing_region</strong>: the region to use for SigV4 signing of requests. e.g. <code>us-east-1</code></li>
<li><strong>sqs_service_endpoint</strong>: the service endpoint either with or without the protocol (e.g. <code>https://sns.us-west-1.amazonaws.com</code> or <code>sns.us-west-1.amazonaws.com</code>)</li>
<li><strong>sqs_queue_uri</strong>: the full SQS queue uri from AWS console. e.g. <code>https://sqs.us-east-1.amazonaws.com/xxxxxxxxxxxx/maxwell</code></li>
</ul>
<p>The producer uses the <a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/sqs/AmazonSQSClient.html">AWS SQS SDK</a>.</p>
<h1 id="sns">SNS</h1>
<hr />
<h2 id="aws-credentials_2">AWS Credentials</h2>
<p>You will need to obtain an IAM user that has the permission to access the SNS topic. The SNS producer also uses <a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/auth/DefaultAWSCredentialsProviderChain.html">DefaultAWSCredentialsProviderChain</a> to get AWS credentials.</p>
<p>See the <a href="http://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/credentials.html">AWS docs</a> on how to setup the IAM user with the Default Credential Provider Chain.</p>
<p>In case you need to set up a different region also along with credentials then default one, see the <a href="http://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/setup-credentials.html#setup-credentials-setting-region">AWS docs</a>.</p>
<h2 id="options_2">Options</h2>
<p>Set the topic arn in the <code>config.properties</code> by setting the <code>sns_topic</code> property to the topic name. FIFO topics should have a <code>.fifo</code> suffix. </p>
<p>Optionally, you can enable <code>sns_attrs</code> to have maxwell attach various attributes to the message for subscription filtering. (Only <code>database</code> and <code>table</code> are currently supported)</p>
<p>The producer uses the <a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/sns/AmazonSNSClient.html">AWS SNS SDK</a>.</p>
<h1 id="nats">Nats</h1>
<hr />
<p>The configurable properties for nats are:</p>
<ul>
<li><code>nats_url</code> - defaults to <strong>nats://localhost:4222</strong></li>
<li><code>nats_subject</code> - defaults to <strong>%{database}.%{table}</strong></li>
</ul>
<p><code>nats_subject</code> defines the Nats subject hierarchy to write to.  <a href="/producers#topic-substitution">Topic substitution</a> is available.
All non-alphanumeric characters in the substitued values will be replaced by underscores.</p>
<h1 id="google-cloud-pubsub">Google Cloud Pub/Sub</h1>
<hr />
<p>In order to publish to Google Cloud Pub/Sub, you will need to obtain an IAM service account that has been granted the <code>roles/pubsub.publisher</code> role.</p>
<p>See the Google Cloud Platform docs for the <a href="https://cloud.google.com/pubsub/docs/access_control">latest examples of which permissions are needed</a>, as well as <a href="https://cloud.google.com/compute/docs/access/create-enable-service-accounts-for-instances">how to properly configure service accounts</a>.</p>
<p>Set the output stream in <code>config.properties</code> by setting the <code>pubsub_project_id</code> and <code>pubsub_topic</code> properties. Optionally configure a dedicated output topic
for DDL updates by setting the <code>ddl_pubsub_topic</code> property.</p>
<p>The producer uses the <a href="https://github.com/GoogleCloudPlatform/google-cloud-java/tree/master/google-cloud-pubsub">Google Cloud Java Library for Pub/Sub</a> and uses its built-in configurations.</p>
<h1 id="google-cloud-bigquery">Google Cloud BigQuery</h1>
<hr />
<p>To stream data into Google Cloud Bigquery, first there must be a table created on bigquery in order to stream the data
into defined as <code>bigquery_project_id.bigquery_dataset.bigquery_table</code>. The schema of the table must match the outputConfig. The column types should be defined as below</p>
<ul>
<li>database: string </li>
<li>table: string                                                                                                    </li>
<li>type: string                                                                                                     </li>
<li>ts: integer                                                                                                      </li>
<li>xid: integer                                                                                                     </li>
<li>xoffset: integer                                                                                                 </li>
<li>commit: boolean                                                                                                  </li>
<li>position: string                                                                                                 </li>
<li>gtid: string                                                                                                     </li>
<li>server_id: integer                                                                                               </li>
<li>primary_key: string                                                                                              </li>
<li>data: string                                                                                                     </li>
<li>old: string</li>
</ul>
<p>See the Google Cloud Platform docs for the <a href="https://cloud.google.com/bigquery/docs/access-control">latest examples of which permissions are needed</a>, as well as <a href="https://cloud.google.com/compute/docs/access/create-enable-service-accounts-for-instances">how to properly configure service accounts</a>.</p>
<p>Set the output stream in <code>config.properties</code> by setting the <code>bigquery_project_id</code>, <code>bigquery_dataset</code> and <code>bigquery_table</code> properties.</p>
<p>The producer uses the <a href="https://github.com/googleapis/java-bigquerystorage">Google Cloud Java Bigquery Storage Library for Bigquery</a> <a href="https://cloud.google.com/bigquery/docs/write-api">Bigquery Storage Write API documenatation</a>.
To use the Storage Write API, you must have <code>bigquery.tables.updateData</code> permissions.</p>
<p>This producer is using the Default Stream with at-least once semantics for greater data resiliency and fewer scaling restrictions</p>
<h1 id="rabbitmq">RabbitMQ</h1>
<hr />
<p>To produce messages to RabbitMQ, you will need to specify a host in <code>config.properties</code> with <code>rabbitmq_host</code>. This is the only required property, everything else falls back to a sane default.</p>
<p>The remaining configurable properties are:</p>
<ul>
<li><code>rabbitmq_user</code> - defaults to <strong>guest</strong></li>
<li><code>rabbitmq_pass</code> - defaults to <strong>guest</strong></li>
<li><code>rabbitmq_virtual_host</code> - defaults to <strong>/</strong></li>
<li><code>rabbitmq_handshake_timeout</code> - defaults to <strong>10000</strong></li>
<li><code>rabbitmq_exchange</code> - defaults to <strong>maxwell</strong></li>
<li><code>rabbitmq_exchange_type</code> - defaults to <strong>fanout</strong></li>
<li><code>rabbitmq_exchange_durable</code> - defaults to <strong>false</strong></li>
<li><code>rabbitmq_exchange_autodelete</code> - defaults to <strong>false</strong></li>
<li><code>rabbitmq_routing_key_template</code> - defaults to <strong>%db%.%table%</strong><ul>
<li>This config controls the routing key, where <code>%db%</code> and <code>%table%</code> are placeholders that will be substituted at runtime</li>
</ul>
</li>
<li><code>rabbitmq_message_persistent</code> - defaults to <strong>false</strong></li>
<li><code>rabbitmq_declare_exchange</code> - defaults to <strong>true</strong></li>
<li><code>rabbitmq_use_ssl</code> - defaults to <strong>false</strong></li>
</ul>
<p>For more details on these options, you are encouraged to the read official RabbitMQ documentation here: <a href="https://www.rabbitmq.com/documentation.html">https://www.rabbitmq.com/documentation.html</a></p>
<h1 id="redis">Redis</h1>
<hr />
<p>Choose type of redis data structure to create to by setting <code>redis_type</code> to one of:
<code>pubsub</code>, <code>xadd</code>, <code>lpush</code> or <code>rpush</code>.  The default is <code>pubsub</code>.</p>
<p><code>redis_key</code> defaults to "maxwell" and supports <a href="#topic-substitution">topic substitution</a></p>
<p>Other configurable properties are:</p>
<ul>
<li><code>redis_host</code> - defaults to <strong>localhost</strong></li>
<li><code>redis_port</code> - defaults to <strong>6379</strong></li>
<li><code>redis_auth</code> - defaults to <strong>null</strong></li>
<li><code>redis_database</code> - defaults to <strong>0</strong></li>
<li><code>redis_type</code> - defaults to <strong>pubsub</strong></li>
<li><code>redis_key</code> - defaults to <strong>maxwell</strong></li>
<li><code>redis_stream_json_key</code> - defaults to <strong>message</strong></li>
<li><code>redis_sentinels</code> - doesn't have a default value</li>
<li><code>redis_sentinel_master_name</code> - doesn't have a default value</li>
</ul>
<h1 id="custom-producer">Custom Producer</h1>
<hr />
<p>If none of the producers packaged with Maxwell meet your requirements, a custom producer can be added at runtime.  </p>
<p>In order to register your custom producer, you must implement the <code>ProducerFactory</code> interface, which is responsible for creating your custom <code>AbstractProducer</code>. Next, set the <code>custom_producer.factory</code> configuration property to your <code>ProducerFactory</code>'s fully qualified class name. Then add the custom <code>ProducerFactory</code> JAR and all its dependencies to the $MAXWELL_HOME/lib directory.</p>
<p>Your custom producer will likely require configuration properties as well. For that, use the <code>custom_producer.*</code> (or <code>CUSTOM_PRODUCER_*</code> if using env-variable configuration) property namespace. Those properties will be available to your producer via <code>MaxwellConfig.customProducerProperties</code>.</p>
<p>Custom producer factory and producer examples can be found here: <a href="https://github.com/zendesk/maxwell/tree/master/src/example/com/zendesk/maxwell/example/producerfactory">https://github.com/zendesk/maxwell/tree/master/src/example/com/zendesk/maxwell/example/producerfactory</a></p>
<h1 id="topic-substitution">Topic substitution</h1>
<p>Some producers may be given a template string from which they dynamically generate a topic (or whatever their equivalent of a kafka topic is).
Subsitutions are enclosed in by <code>%{}</code>.  The following substitutions are available:</p>
<ul>
<li><code>%{database}</code></li>
<li><code>%{table}</code></li>
<li><code>%{type}</code> (insert/update/delete)</li>
</ul>
<p>Topic substituion is available in the following producers:</p>
<ul>
<li>Kakfa, for topics</li>
<li>Redis, for channels</li>
<li>Nats, for subject heirarchies</li>
</ul>
    </div>
</div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
