<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Bootstrapping - Maxwell's Daemon</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../maxwell.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">Maxwell's Daemon</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../quickstart/" class="nav-link">Quick Start</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Configuration <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../config/" class="dropdown-item">Reference</a>
</li>
                                    
<li>
    <a href="../deployment/" class="dropdown-item">Deployment</a>
</li>
                                    
<li>
    <a href="../producers/" class="dropdown-item">Producers</a>
</li>
                                    
<li>
    <a href="../filtering/" class="dropdown-item">Filtering</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Bootstrapping</a>
</li>
                                    
<li>
    <a href="../dataformat/" class="dropdown-item">Data Format</a>
</li>
                                    
<li>
    <a href="../encryption/" class="dropdown-item">Encryption</a>
</li>
                                    
<li>
    <a href="../monitoring/" class="dropdown-item">Monitoring</a>
</li>
                                    
<li>
    <a href="../high_availability/" class="dropdown-item">High Availability</a>
</li>
                                    
<li>
    <a href="../embedding/" class="dropdown-item">Embedding</a>
</li>
                                    
<li>
    <a href="../schemas/" class="dropdown-item">Internals</a>
</li>
                                    
<li>
    <a href="../compat/" class="dropdown-item">Compatibility</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../changelog/" class="nav-link">Changelog</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../filtering/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../dataformat/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
<div class="col-md-3">
<div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#bootstrapping" class="nav-link">Bootstrapping</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#using-the-maxwell-bootstrap-utility" class="nav-link">Using the maxwell-bootstrap utility</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#starting-a-table-bootstrap" class="nav-link">Starting a table bootstrap</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#async-vs-sync-bootstrapping" class="nav-link">Async vs Sync bootstrapping</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#bootstrapping-data-format" class="nav-link">Bootstrapping Data Format</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#failure-scenarios" class="nav-link">Failure Scenarios</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div>
</div>
<div class="col-md-9" role="main">
    <div id="Bootstrapping">
        

<h1 id="bootstrapping">Bootstrapping</h1>
<p>Maxwell allows you to "bootstrap" data into your stream.  This will perform a
<code>select * from table</code> and output the results into your stream, allowing you
to recreate your entire dataset by playing the stream from the start.</p>
<h1 id="using-the-maxwell-bootstrap-utility">Using the maxwell-bootstrap utility</h1>
<hr />
<p>You can use the <code>maxwell-bootstrap</code> utility to begin boostrap operations from the command-line.</p>
<table>
<thead>
<tr>
<th>option</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>--log_level LOG_LEVEL</td>
<td>log level (DEBUG, INFO, WARN or ERROR)</td>
</tr>
<tr>
<td>--user USER</td>
<td>mysql username</td>
</tr>
<tr>
<td>--password PASSWORD</td>
<td>mysql password</td>
</tr>
<tr>
<td>--host HOST</td>
<td>mysql host</td>
</tr>
<tr>
<td>--port PORT</td>
<td>mysql port</td>
</tr>
<tr>
<td>--database DATABASE</td>
<td>mysql database containing the table to bootstrap</td>
</tr>
<tr>
<td>--table TABLE</td>
<td>mysql table to bootstrap</td>
</tr>
<tr>
<td>--where WHERE_CLAUSE</td>
<td>where clause to restrict the rows bootstrapped from the specified table</td>
</tr>
<tr>
<td>--client_id CLIENT_ID</td>
<td>specify which maxwell instance should perform the bootstrap operation</td>
</tr>
<tr>
<td>--comment COMMENT</td>
<td>arbitrary comment to be added to every bootstrap row record</td>
</tr>
</tbody>
</table>
<h2 id="starting-a-table-bootstrap">Starting a table bootstrap</h2>
<hr />
<p>You can start a bootstrap using:</p>
<pre><code>bin/maxwell-bootstrap --database fooDB --table barTable
</code></pre>
<p>Optionally, you can include a where clause to replay part of the data.</p>
<pre><code>bin/maxwell-bootstrap --database fooDB --table barTable --where &quot;my_date &gt;= '2017-01-07 00:00:00'&quot;
</code></pre>
<p>Alternatively you can insert a row in the <code>maxwell.bootstrap</code> table to trigger a bootstrap.</p>
<pre><code>mysql&gt; insert into maxwell.bootstrap (database_name, table_name) values ('fooDB', 'barTable');
</code></pre>
<p>Note that if a Maxwell client_id has been set you should specify the client id.</p>
<pre><code>mysql&gt; insert into maxwell.bootstrap (database_name, table_name, client_id) values ('fooDB', 'barTable', 'custom_maxwell_client_id');
</code></pre>
<p>You can schedule bootstrap tasks to be run in the future by setting the started_at column. Maxwell will wait until this time to start the bootstrap.</p>
<pre><code>mysql&gt; insert into maxwell.bootstrap (database_name, table_name, client_id, started_at) values ('fooDB', 'barTable', 'custom_maxwell_client_id', '2020-05-18 12:30:00');
</code></pre>
<h1 id="async-vs-sync-bootstrapping">Async vs Sync bootstrapping</h1>
<hr />
<p>The Maxwell replicator is single threaded; events are captured by one thread from the binlog and replicated to Kafka one message at a time.
When running Maxwell with <code>--bootstrapper=sync</code>, the same thread is used to do bootstrapping, meaning that all binlog events are blocked until bootstrapping is complete.
Running Maxwell with <code>--bootstrapper=async</code> however, will make Maxwell spawn a separate thread for bootstrapping.
In this async mode, non-bootstrapped tables are replicated as normal by the main thread, while the binlog events for bootstrapped tables are queued and sent to the replication stream at the end of the bootstrap process.</p>
<h1 id="bootstrapping-data-format">Bootstrapping Data Format</h1>
<hr />
<ul>
<li>a bootstrap starts with an event of <code>type = "bootstrap-start"</code></li>
<li>then events with <code>type = "bootstrap-insert"</code> (one per row in the table)</li>
<li>then one event per <code>INSERT</code>, <code>UPDATE</code> or <code>DELETE</code> with standard event types i.e. <code>type = "insert"</code>, <code>type = "update"</code> or <code>type = "delete"</code> that occurred since the beginning of bootstrap</li>
<li>finally an event with <code>type = "bootstrap-complete"</code></li>
</ul>
<p>Here's a complete example:</p>
<pre><code>mysql&gt; create table fooDB.barTable(txt varchar(255));
mysql&gt; insert into fooDB.barTable (txt) values (&quot;hello&quot;), (&quot;bootstrap!&quot;);
mysql&gt; insert into maxwell.bootstrap (database_name, table_name) values (&quot;fooDB&quot;, &quot;barTable&quot;);
</code></pre>
<p>Corresponding replication stream output of table <code>fooDB.barTable</code>:</p>
<pre><code>{&quot;database&quot;:&quot;fooDB&quot;,&quot;table&quot;:&quot;barTable&quot;,&quot;type&quot;:&quot;insert&quot;,&quot;ts&quot;:1450557598,&quot;xid&quot;:13,&quot;data&quot;:{&quot;txt&quot;:&quot;hello&quot;}}
{&quot;database&quot;:&quot;fooDB&quot;,&quot;table&quot;:&quot;barTable&quot;,&quot;type&quot;:&quot;insert&quot;,&quot;ts&quot;:1450557598,&quot;xid&quot;:13,&quot;data&quot;:{&quot;txt&quot;:&quot;bootstrap!&quot;}}
{&quot;database&quot;:&quot;fooDB&quot;,&quot;table&quot;:&quot;barTable&quot;,&quot;type&quot;:&quot;bootstrap-start&quot;,&quot;ts&quot;:1450557744,&quot;data&quot;:{}}
{&quot;database&quot;:&quot;fooDB&quot;,&quot;table&quot;:&quot;barTable&quot;,&quot;type&quot;:&quot;bootstrap-insert&quot;,&quot;ts&quot;:1450557744,&quot;data&quot;:{&quot;txt&quot;:&quot;hello&quot;}}
{&quot;database&quot;:&quot;fooDB&quot;,&quot;table&quot;:&quot;barTable&quot;,&quot;type&quot;:&quot;bootstrap-insert&quot;,&quot;ts&quot;:1450557744,&quot;data&quot;:{&quot;txt&quot;:&quot;bootstrap!&quot;}}
{&quot;database&quot;:&quot;fooDB&quot;,&quot;table&quot;:&quot;barTable&quot;,&quot;type&quot;:&quot;bootstrap-complete&quot;,&quot;ts&quot;:1450557744,&quot;data&quot;:{}}
</code></pre>
<h1 id="failure-scenarios">Failure Scenarios</h1>
<hr />
<p>If Maxwell crashes during bootstrapping the next time it runs it will rerun the bootstrap in its entirety - regardless of previous progress.
If this behavior is not desired, manual updates to the <code>bootstrap</code> table are required.
Specifically, marking the unfinished bootstrap row as 'complete' (<code>is_complete</code> = 1) or deleting the row.</p>
<script>
  jQuery(document).ready(function () {
    jQuery("table").addClass("table table-condensed table-bordered table-hover");
  });
</script>
    </div>
</div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
